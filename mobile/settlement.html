<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ì •ì‚° ê´€ë¦¬</title>
  <link rel="stylesheet" href="/css/layout.css">
  <link rel="stylesheet" href="/mobile/css/mobile.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/js/supabaseclient.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <!-- ê³µí†µ í—¤ë” -->
  <div id="header"></div>
  
  <!-- ê³µí†µ Drawer -->
  <div id="drawer-container"></div>
  
  <script>
    Promise.all([
      fetch("/components/header.html").then(r => r.text()),
      fetch("/components/drawer.html").then(r => r.text())
    ]).then(([header, drawer]) => {
      document.getElementById("header").innerHTML = header;
      document.getElementById("drawer-container").innerHTML = drawer;
      
      // ë ˆì´ì•„ì›ƒ JS ë¡œë“œ
      const script = document.createElement("script");
      script.src = "/js/layout.js";
      script.onload = () => {
        if (window.updatePageTitle) {
          window.updatePageTitle('ì •ì‚° ê´€ë¦¬');
        }
        if (window.initLayout) {
          window.initLayout();
        }
      };
      document.body.appendChild(script);
    });
  </script>

  <!-- ì»¨í…ì¸  -->
  <div class="m-content" style="padding-top: 48px;">
    <div class="m-container">
      <!-- í•„í„° -->
      <div class="m-filter-bar">
        <select class="m-filter-select" id="monthFilter">
          <option value="">ì›” ì„ íƒ</option>
        </select>
        <select class="m-filter-select" id="workshopFilter">
          <option value="">ì‹œê³µì  ì „ì²´</option>
        </select>
        <select class="m-filter-select" id="statusFilter">
          <option value="">ì „ì²´</option>
          <option value="ë¯¸ì •ì‚°">ë¯¸ì •ì‚°</option>
          <option value="ì •ì‚°ì™„ë£Œ">ì •ì‚°ì™„ë£Œ</option>
        </select>
      </div>

      <!-- ì •ì‚° ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ -->
      <div id="settlementList">
        <div class="m-loading">ë¡œë”© ì¤‘...</div>
      </div>
    </div>
  </div>

  <!-- í•˜ë‹¨ ê³ ì • ë²„íŠ¼ -->
  <div style="position: fixed; bottom: 60px; left: 0; right: 0; padding: 12px 16px; background: white; border-top: 1px solid var(--border); z-index: 999;">
    <button class="m-btn m-btn-primary" onclick="settleSelected()" style="margin-bottom: 8px;">ì„ íƒ ê±´ ì •ì‚° ì™„ë£Œ</button>
    <button class="m-btn m-btn-secondary" onclick="downloadExcel()">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
  </div>

  <!-- í•˜ë‹¨ íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
  <div class="m-bottom-nav">
    <div class="m-bottom-nav-item" data-page="status">
      <div class="m-bottom-nav-icon">ğŸ“‹</div>
      <div class="m-bottom-nav-label">ì ‘ìˆ˜í˜„í™©</div>
    </div>
    <div class="m-bottom-nav-item" data-page="receive">
      <div class="m-bottom-nav-icon">â•</div>
      <div class="m-bottom-nav-label">ì ‘ìˆ˜</div>
    </div>
    <div class="m-bottom-nav-item" data-page="map">
      <div class="m-bottom-nav-icon">ğŸ“</div>
      <div class="m-bottom-nav-label">ì§€ë„</div>
    </div>
    <div class="m-bottom-nav-item" data-page="message">
      <div class="m-bottom-nav-icon">ğŸ’¬</div>
      <div class="m-bottom-nav-label">ë©”ì‹œì§€</div>
    </div>
    <div class="m-bottom-nav-item" data-page="more">
      <div class="m-bottom-nav-icon">â‹¯</div>
      <div class="m-bottom-nav-label">ë”ë³´ê¸°</div>
    </div>
  </div>

  <script src="/mobile/js/settlement.js"></script>
</body>
</html>

